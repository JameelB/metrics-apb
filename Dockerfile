FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IG1ldHJpY3MtYXBiCmRlc2NyaXB0aW9uOiBJbnN0YWxscyBhIG1l\
dHJpY3Mgc2VydmljZSBiYXNlZCBvbiBQcm9tZXRoZXVzIGFuZCBHcmFmYW5hCmJpbmRhYmxlOiBG\
YWxzZQphc3luYzogb3B0aW9uYWwKdGFnczoKICAtIG1vYmlsZS1zZXJ2aWNlCm1ldGFkYXRhOgog\
IGRpc3BsYXlOYW1lOiBNZXRyaWNzCiAgaW1hZ2VVcmw6ICJodHRwczovL2F2YXRhcnMxLmdpdGh1\
YnVzZXJjb250ZW50LmNvbS91LzMzODA0NjI/cz0yMDAmdj00IgogIGRvY3VtZW50YXRpb25Vcmw6\
ICJodHRwczovL3Byb21ldGhldXMuaW8vZG9jcy9pbnRyb2R1Y3Rpb24vb3ZlcnZpZXcvIgogIHBy\
b3ZpZGVyRGlzcGxheU5hbWU6ICJSZWQgSGF0LCBJbmMuIgogIHNlcnZpY2VOYW1lOiBtZXRyaWNz\
CnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IFRoaXMgcGxhbiBzZXRz\
IHVwIFByb21ldGhldXMgYW5kIEdyYWZhbmEgZm9yIG1ldHJpY3MgYW5kIGRhdGEgdmlzdWFsaXNh\
dGlvbgogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6IHt9CiAgICBwYXJhbWV0ZXJzOiAKICAg\
ICAgLSBuYW1lOiBHUkFGQU5BX1NUT1JBR0VfU0laRQogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAg\
ICAgICAgZGVmYXVsdDogMTAKICAgICAgICB0eXBlOiBudW1iZXIKICAgICAgICB0aXRsZTogR3Jh\
ZmFuYSBTdG9yYWdlIFNpemUgKEdiKQogICAgICAtIG5hbWU6IFBST01FVEhFVVNfU1RPUkFHRV9T\
SVpFCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICBkZWZhdWx0OiAxMAogICAgICAgIHR5\
cGU6IG51bWJlcgogICAgICAgIHRpdGxlOiBQcm9tZXRoZXVzIFN0b3JhZ2UgU2l6ZSAoR2IpCiAg\
ICAgIC0gbmFtZTogUE9TVEdSRVNfU1RPUkFHRV9TSVpFCiAgICAgICAgcmVxdWlyZWQ6IFRydWUK\
ICAgICAgICBkZWZhdWx0OiAxMAogICAgICAgIHR5cGU6IG51bWJlcgogICAgICAgIHRpdGxlOiBQ\
b3N0Z3JlcyBTdG9yYWdlIFNpemUgKEdiKQogICAgICAtIG5hbWU6IFBPU1RHUkVTX1VTRVIKICAg\
ICAgICBkZXNjcmlwdGlvbjogVXNlcm5hbWUgdGhhdCB3aWxsIGJlIHVzZWQgdG8gY29ubmVjdCB0\
byBwb3N0Z3JlcyAoJ3VzZXInIHdpbGwgYmUgdXNlZCBpZiBibGFuaykKICAgICAgICBkZWZhdWx0\
OiB1c2VyCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAg\
ICAgdGl0bGU6IFBvc3RncmVzIFVzZXIKICAgICAgLSBuYW1lOiBQT1NUR1JFU19QQVNTV09SRAog\
ICAgICAgIGRlc2NyaXB0aW9uOiBQYXNzd29yZCB0byBjb25uZWN0IHRvIFBvc3RncmVzIChnZW5l\
cmF0ZWQgaWYgYmxhbmspCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IEZh\
bHNlCiAgICAgICAgdGl0bGU6IFBvc3RncmVzIFBhc3N3b3JkCiAgICAgICAgCg=="




COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
